---
type: rule
archivedreason: 
title: Do you run the Code Health checks in your VisualStudio.com Continuous Integration Build?
guid: 049c8237-303a-43f1-b0b4-1432e8908c1c
uri: do-you-run-the-code-health-checks-in-your-visualstudiocom-continuous-integration-build
created: 2017-03-09T22:13:05.0000000Z
authors:
- title: Adam Cogan
  url: https://ssw.com.au/people/adam-cogan
- title: Danijel Malik
  url: https://ssw.com.au/people/danijel-malik
related: []
redirects: []

---


The real value of the code health system is that is made improvements in code quality more visible to the team and managers. By including several steps to the build process, the results of the analysers included in previous steps can be extracted out and summarisised in a report spanning the project's lifetime.&#160;<br>
<br><excerpt class='endintro'></excerpt><br>
<h3 class="ssw15-rteElement-H3">​​Related Steps to Code Health&#58;​​<br></h3><p></p><ul><li><a href="/_layouts/15/FIXUPREDIRECT.ASPX?WebId=3dfc0e07-e23a-4cbb-aac2-e778b71166a2&amp;TermSetId=07da3ddf-0924-4cd2-a6d4-a4809ae20160&amp;TermId=b30bb5f2-6ac1-4f56-8975-dad84b0ba489">Do you&#160;know the Code Health (Quality Gates) to add?</a><br></li><li><a href="/_layouts/15/FIXUPREDIRECT.ASPX?WebId=3dfc0e07-e23a-4cbb-aac2-e778b71166a2&amp;TermSetId=07da3ddf-0924-4cd2-a6d4-a4809ae20160&amp;TermId=1e14fbd6-0c72-4791-9c79-893de1fdd89e">Do you use the Code Health Extensions in VS Code?​</a><br></li><li><a href="/_layouts/15/FIXUPREDIRECT.ASPX?WebId=3dfc0e07-e23a-4cbb-aac2-e778b71166a2&amp;TermSetId=07da3ddf-0924-4cd2-a6d4-a4809ae20160&amp;TermId=9e155c90-0502-447a-a1a3-fb2b1580982a">Do you use the Code Health Extensions in Visual Studio?</a><br></li></ul>​<p></p><h3 class="ssw15-rteElement-H3">​What Steps to Include in the B​​​uild Definition​</h3><p>Ensure&#160;utilisation of TeamBuild2015 or higher. (No support for XAML builds)<br>​​​​The end result should look like this.<br>Figu​​re&#58;&#160;​Good Example - Build Passing with no summary issues<br></p><dd class="ssw15-rteElement-FigureGood">Figure&#58; Good Examp​​​​​​le -&#160;Steps ​​added to&#160;build definition.</dd><p>​​​</p><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Exa​mp​​​le director​​y for TSLint run commands</dd><p>Under advanced for the Command Line tasks, the Working Directory can be specified if necessary.<br>TsLint​<br>Npm&#160;- Install tslint and typescript<br>Name​&#58;&#160;npm install tslint<br>​​​Working Folder&#58;&#160;&lt;Top Directory&gt;<br>Npm Command&#58;&#160;install<br>Arguments&#58;&#160;-g tslint typescript<br>Command Line&#160;- Check the version&#160;​​​(Useful to determine rule discrepancies across builds)<br>Name​&#58; Check tslint version<br>Tool&#58;&#160;tslint<br>Arguments&#58;&#160;-v<br>Command Line&#160;-&#160;Builds a default configuration file for the build (Without it issues can differ between build and development environment<br>Name​&#58;&#160;Create tslint config file<br>Tool&#58;&#160;tslint<br>Arguments&#58;&#160;--init<br>Command Line&#160;- Run tslint, force is required to stop the build from crashing (TSLint will return and exit code of 1 regardless of if issues exist)<br>Name​&#58;&#160;​Run&#160;tslint<br>Tool&#58;​&#160;TSLint<br>Arguments&#58;&#160;--force &lt;Solution Directory&gt;/**/*.ts&#123;,x&#125;<br><br>If your build is being hosted, then the config file must be reloaded every time.&#160;<span class="ssw15-rteStyle-Highlight">If your build is running on premises</span>, the config file will attempt to load over the existing one and break the build.<br>If this is the case, just add a step to delete your config file after the scan is complete.</p><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Command line​ s​​​tep to remove the&#160;config file (tslint.json) after the linter has run</dd><p>​Command Line&#160;- Remove the tslint config file, as it will break future scan if the build is on premises if a config file already exists and an attempt to add another one is made.<br>​​​Name​&#58;&#160;​Remove tslint config<br>​Tool&#58;​&#160;del<br>​Arguments&#58;&#160;tslint.json​<br>Once complete, save the build definition and run the build.​<br>Then check the build is successful.<br>If the build fails (due to errors), these should be corrected in the development environment.&#160;<br>If warnings&#160;exist, the rule should be disabled or set as an error. (If it is worth fixing, then it should be required for everyone)<br>​​​​At the moment, it is fine to leave the warnings in the build, since the defined standard of rules is not set<br>​​​<br>If your project does not contain TypeScript files, then you do not need to include the TSLint build tasks.<br>​Figure&#58; Ensure TSLint actually finds files to​​​ scan (if the project includes TSLint files) otherwise it will pass without you noticing<br>​For the purposes of reporting, a unique tag must be added to the build definition which the Code Health steps have been applied to. ​<br>This is done with the addition of a variable (Name = PrimaryBuild, Value = true)​</p><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Steps to add PrimaryBuild​​ variable to build definition​​​​​​​​​​​​</dd><dd class="ssw15-rteElement-FigureBad">​​Figu​re&#58; Bad Example - B​uild broke due to com​​​pile errors. Must fix to proceed.​</dd><p>​​</p><dd class="ssw15-rteElement-FigureBad">​​​​​​​​​​Figure&#58; Bad Example -&#160;​Successful​​​​ build with warnings. Should be disabled or set as errors.​​</dd><p>​​​​​​</p><dd class="ssw15-rteElement-FigureGood">​​​​​​​​​Figure&#58;&#160;Good Example - S​​uccessful build with ​​​no warnings.</dd><p>​<br>​​<br></p>



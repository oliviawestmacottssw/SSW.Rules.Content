---
type: rule
archivedreason: 
title: Do you know the Code Health (Quality Gates) to add?
guid: 316c617a-3636-4c40-85dc-c94fdc98fbfa
uri: do-you-know-the-code-health-quality-gates-to-add
created: 2017-02-20T22:26:58.0000000Z
authors:
- title: Adam Cogan
  url: https://ssw.com.au/people/adam-cogan
- title: Danijel Malik
  url: https://ssw.com.au/people/danijel-malik
related: []
redirects: []

---


​​Code health is all about quality and consistency. Here is how to&#160;use various auditors and linters not just in your development environment, but also on your VisualStudio.com build.<br>
<br><excerpt class='endintro'></excerpt><br>
<p>Depending on your development environment&#160;and the type of project, you should utilise different auditing tools.<br>&#160;1) Visual Studio - How to install and modify Visual Studio Analysers<br>&#160;2) Visual Studio Code - How to include TSLint and CSSLint extensions<br>&#160;3) VisualStudio.com - How to produce a build script which analyses code as part of the build process​​<br></p><p>Following the steps should take about 15 minutes to do, but longer to implement depending on the size of your solution. (Requires solution analysis in VS and at least one build on VisualStudio.com)<br></p><p class="ssw15-rteElement-InfoBox">​Version 1.0<br>(Version used to track changes to the code health definition for consistency reasons)<br></p><h3 class="ssw15-rteElement-H3">Visual Studio<br></h3><p>Search &amp; Install the NuGet packages&#58;<br><span class="ssw15-rteStyle-IndentText">​&quot;Roslyn Security Guard &quot; <a href="https&#58;//www.nuget.org/packages/RoslynSecurityGuard/">https&#58;//www.nuget.org/packages/RoslynSecurityGuard/</a></span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText">&quot;StyleCop.Analysers&quot; <a href="https&#58;//www.nuget.org/packages/StyleCop.Analyzers/1.0.0">https&#58;//www.nuget.org/packages/StyleCop.Analyzers/1.0.0</a></span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText">&quot;tslint&quot;&#160;<a href="https&#58;//www.nuget.org/packages/tslint/">https&#58;//www.nuget.org/packages/tslint/</a></span><br>At the moment there is no NuGet package just for CSSLint.<br>​<br></p><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VS-InstallNuGetPackages.png" alt="VS-InstallNuGetPackages.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Steps to install NuGet Packages</dd><p class="ssw15-rteElement-P">​Here is a quick guide to the steps to install Nuget Packages to the entire solution&#58;<br>&#160;1) Right click solution<br>&#160;2)&#160;Select &quot;Manage NuGet packages for solution&quot;<br>&#160;3) Select &quot;Browse&quot;<br>&#160;4) Search &lt;package name&gt;<br>&#160;5) Select &lt;package name&gt;<br>&#160;6) Check all projects<br>&#160;7)&#160;Click &quot;Install&quot;<br><br>Issues from these will now be returned in the Visual Studio analyser error list.<br></p><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VS-RoslynRules.png" alt="VS-RoslynRules.png" style="margin&#58;5px;" />​​​​<span style="color&#58;#555555;font-size&#58;0.9rem;font-weight&#58;bold;">​</span><span style="color&#58;#555555;font-size&#58;0.9rem;font-weight&#58;bold;">​Figure&#58; New Roslyn Rule issues raised in Visual Studio Analyser</span></dl><p class="ssw15-rteElement-P"><br>Run Code Analysis on the project. Check over all of the warnings, if they are unnecessary or inappropriate, disable them, otherwise modify their severity level to &quot;Error&quot;.&#160;<br>When the build is run, &quot;Errors&quot; will break the build, while &quot;Warnings&quot; will be reported, but not break the build.<br>Rules which have been flagged should also be checked once the build is completed<br></p><h3 class="ssw15-rteElement-H3">Modify Visual Studio Analysis<br></h3><p class="ssw15-rteElement-P">​​The goal is to develop a shared ruleset across projects. (Currently this is just the default settings)<br>Any project specific rules should be documented in &quot;_Instructions-CodeHealth.docx&quot; kept in the solution.<br><span class="ssw15-rteStyle-Highlight">Please also copy the current version number of this rule into the&#160;&quot;_Instructions-CodeHealth.docx&quot; in order to track what version your existing solution adheres to.</span><br>​<br></p><div><div class="ssw15-rteElement-ContentBlock-SSW-Only">The current standard for rules&#160;is just the default ones. Frequently check back here for updates to&#160;the ruleset definition.<br></div><dl class="ssw15-rteElement-ImageArea"><dl class="ssw15-rteElement-ImageArea">​​​​<img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VS-ModifyRules.png" alt="VS-ModifyRules.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureNormal">​​​Figure&#58; Steps to open Visual Studio Analyser rules customisation page<br></dd><p class="ssw15-rteElement-P">​Right Click project &gt; Properties &gt; Code Analysis &gt; Open<br></p></dl><dl class="ssw15-rteElement-ImageArea"><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VS-ModifyRules2.png" alt="VS-ModifyRules2.png" style="margin&#58;5px;width&#58;808px;" /><dd class="ssw15-rteElement-FigureNormal">​​Figure&#58; How to&#160;customize rules. By either enabling / disabling rules or packages. Or by modifying the rule severity level.<br></dd></dl></dl><h3 class="ssw15-rteElement-H3">Visual Studio Code<br></h3><p>​For web projects, we advocate the use of CSSLint for css files and TSLint for typescript files. (<a href="/_layouts/15/FIXUPREDIRECT.ASPX?WebId=3dfc0e07-e23a-4cbb-aac2-e778b71166a2&amp;TermSetId=07da3ddf-0924-4cd2-a6d4-a4809ae20160&amp;TermId=d82703e0-6244-4fb6-9017-bac4e4b2361d">Why you should be using TypeScript instead of JavaScript​</a>)<br></p><p>Linters for these can be easily added to VS Code via extensions.<br>Simply select the &quot;Extensions&quot; tab, search for &quot;CSSLint&quot; and &quot;TSLint&quot; and click &quot;Install&quot; on each respectively.​<br></p><dl class="ssw15-rteElement-ImageArea">​<img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSCode-Extensions.png" alt="VSCode-Extensions.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Addition of CssLint and TSLint to VS Code Project<br></dd><p>If you prefer not to use the Extensions (which are currently a bit out of date). You can install them using npm as normal.​​<br></p><p>CssLint&#160;<a href="https&#58;//www.npmjs.com/package/csslint">https&#58;//www.npmjs.com/package/csslint​</a><br>TSLint&#160;<a href="https&#58;//www.npmjs.com/package/tslint">https&#58;//www.npmjs.com/package/tslint</a>​<br></p><h3 class="ssw15-rteElement-H3">​Automatically Check your Build in VisualStudio.com<br></h3><p><span class="ssw15-rteStyle-Highlight">Ensure&#160;utilisation of TeamBuild2015 or higher. (No support for XAML builds)</span><br>Edit the build definition​<br></p><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-EditBuild.png" alt="VSO-EditBuild.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureNormal">Figure&#58; Steps to edit an existing build definition on VisualStudio.com&#160;​​</dd><p>Select &quot;Build &amp; Release&quot; &gt;&#160;Select &quot;Builds&quot; &gt;&#160;Click on your existing build &gt; Click&#160;&quot;Edit&quot;<br></p><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-BuildDefinition.png" alt="VSO-BuildDefinition.png" style="margin&#58;5px;width&#58;808px;" /><dd class="ssw15-rteElement-FigureNormal">​​Figure&#58; Example completed build definition.<br></dd></dl><dl><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-DirectoryExample.png" alt="VSO-DirectoryExample.png" style="margin&#58;5px;width&#58;650px;" /></dl><dd class="ssw15-rteElement-FigureNormal">​Figure&#58; Example directory for CSSLint and TSLint run commands<br></dd></dl><p>​Under advanced for the Command Line tasks, the Working Directory can be specified if necessary.</p><p><span class="ssw15-rteStyle-Caption">Csslint​</span></p><p class="ssw15-rteElement-P">​​​​​<strong>Npm </strong>- Install csslint<br><span class="ssw15-rteStyle-IndentText"><strong>Working Folder&#58;</strong> &lt;Top Directory&gt;</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Npm Command&#58;</strong> install</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58; </strong>-g csslint</span></p><p><strong>Command Line</strong> - Check the version (Useful to determine rule discrepancies&#160;across builds)<br><span class="ssw15-rteStyle-IndentText"><strong>Tool&#58;</strong> csslint</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58;</strong> --version</span></p><p class="ssw15-rteElement-P"><strong>​​​Command Line</strong> - Run csslint, the compact format makes the output less bloated<br><span class="ssw15-rteStyle-IndentText"><strong>Tool&#58;</strong> csslint</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58;</strong> --format=compact &lt;Solution Directory&gt;&#160;<span class="ssw15-rteStyle-Highlight">(DO NOT LEAVE BLANK - At least specify topmost directory)</span></span></p><p><span class="ssw15-rteStyle-Caption">TsLint</span></p><p><strong>Npm </strong>- Install tslint and typescript<br><span class="ssw15-rteStyle-IndentText"><strong>Working Folder&#58; &lt;</strong>Top Directory&gt;</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Npm Command&#58;</strong> install</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58;</strong> -g tslint typescript</span></p><p class="ssw15-rteElement-P"><strong>Command Line</strong> - Check the version&#160;​​​(Useful to determine rule discrepancies across builds)<br><span class="ssw15-rteStyle-IndentText"><strong>Tool&#58; </strong>tslint</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58;</strong> -v</span></p><p><strong>Command Line</strong> -&#160;Builds a default configuration file for the build (Without it issues can differ between build and development environment<br><span class="ssw15-rteStyle-IndentText"><strong>Tool&#58;</strong> tslint</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Arguments&#58;</strong> --init</span><br></p><p><strong>Command Line</strong> - Run tslint, force is required to stop the build from crashing (TSLint will return and exit code of 1 regardless of if issues exist)<br><span class="ssw15-rteStyle-IndentText"><strong>Tool&#58;</strong> tslint</span><br class="ssw15-rteStyle-IndentText"><span class="ssw15-rteStyle-IndentText"><strong>Argumen</strong><strong>ts&#58;</strong> --force &lt;Solution Directory&gt;/**/*.ts&#123;,x&#125;</span><br>​​<br></p><p>Once complete, save the build definition and run the build.​<br>Then check the build is successful.<br>If the build fails (due to errors), these should be corrected in the development environment. <br>If warnings&#160;exist, the rule should be disabled or set as an error. (If it is worth fixing, then it should be required for everyone)<br></p><div class="ssw15-rteElement-ContentBlock-SSW-Only">​​​At the moment, it is fine to leave the warnings in the build, since the defined standard of rules is not set<br></div><dl class="ssw15-rteElement-ImageArea">​<img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-BuildResult-Bad.png" alt="VSO-BuildResult-Bad.png" style="margin&#58;5px;width&#58;808px;" /><dd class="ssw15-rteElement-FigureBad">​​​Figure&#58; Bad Example - Build broke due to compile errors. Must fix to proceed.<span style="background-color&#58;initial;color&#58;#333333;font-size&#58;13px;">​</span></dd></dl><dl class="ssw15-rteElement-ImageArea"><dl class="ssw15-rteElement-ImageArea"><img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-BuildResult.png" alt="VSO-BuildResult.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureBad">​​​​​​Figure&#58; Bad Example -&#160;Successful build with warnings. Should be disabled or set as errors.<span style="background-color&#58;initial;color&#58;#333333;font-size&#58;13px;">​​</span></dd><dl class="ssw15-rteElement-ImageArea">​<img src="/SiteAssets/do-you-know-the-code-health-(quality-gates)-to-add/VSO-BuildResult-Good.png" alt="VSO-BuildResult-Good.png" style="margin&#58;5px;width&#58;808px;" /></dl><dd class="ssw15-rteElement-FigureGood">​​​​​​​​​​Figure&#58;&#160;Good Example - Successful build with no warnings.<br></dd></dl><p><br><br></p></div>


